- name: Get libvirt nodepool IP addresses
  script: "get-domain-ip.sh {{ item.name }}"
  register: "ip_result"
  until: "ip_result is success"
  retries: "{{ libvirt_wait_retries }}"
  delay: "{{ libvirt_wait_delay }}"

- name: Set_fact for undercloud ip
  set_fact:
    "{{ item.name.replace('-', '_') }}_ip": "{{ ip_result.stdout_lines[0] }}"
    cacheable: true
